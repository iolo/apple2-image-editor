<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>apple2-image-editor</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="app">
      <header class="app-header">
        <h1>apple2-image-editor</h1>
        <div class="toolbar">
          <button id="newButton" type="button">New</button>
          <button id="openButton" type="button">Open</button>
          <button id="saveButton" type="button">Save</button>
          <button id="settingsButton" type="button">Settings</button>
          <button id="aboutButton" type="button">About</button>
          <input
            id="fileInput"
            type="file"
            accept=".gr,.dgr,.hgr,.dhgr,.pixmap,.bitmap,.png,.jpg,.jpeg,.webp,.gif,.bmp"
            hidden
          />
        </div>
      </header>

      <main class="app-main">
        <section class="panel toolbox" aria-label="Drawing toolbox">
          <div class="tool-row">
            <button
              id="undoButton"
              type="button"
              title="Undo (Ctrl+Z)"
              aria-label="Undo"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M7 8H3l4-4m0 4h8a6 6 0 1 1-6 6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <button
              id="redoButton"
              type="button"
              title="Redo (Ctrl+Y)"
              aria-label="Redo"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M17 8h4l-4-4m0 4H9a6 6 0 1 0 6 6"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          <div
            class="tool-row tools"
            id="toolButtons"
            role="group"
            aria-label="Tools"
          >
            <button
              type="button"
              data-tool="select"
              title="Select"
              aria-label="Select"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <rect
                  x="2"
                  y="2"
                  width="20"
                  height="20"
                  fill="none"
                  stroke="currentColor"
                  stroke-dasharray="1,3"
                  stroke-linecap="round"
                  stroke-width="2"
                />
              </svg>
            </button>
            <button
              type="button"
              data-tool="pencil"
              class="active"
              title="Pencil"
              aria-label="Pencil"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M4 20l4-1 10-10-3-3L5 16l-1 4zM14 6l3 3"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <button
              type="button"
              data-tool="line"
              title="Line"
              aria-label="Line"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M5 19L19 5"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                />
              </svg>
            </button>
            <button
              type="button"
              data-tool="rect"
              title="Rect"
              aria-label="Rect"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <rect
                  x="5"
                  y="6"
                  width="14"
                  height="12"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
            </button>
            <button
              type="button"
              data-tool="rectFill"
              title="Rect fill"
              aria-label="Rect fill"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <rect x="5" y="6" width="14" height="12" fill="currentColor" />
              </svg>
            </button>
            <button
              type="button"
              data-tool="ellipse"
              title="Ellipse"
              aria-label="Ellipse"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <ellipse
                  cx="12"
                  cy="12"
                  rx="7"
                  ry="5"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
            </button>
            <button
              type="button"
              data-tool="ellipseFill"
              title="Ellipse fill"
              aria-label="Ellipse fill"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <ellipse cx="12" cy="12" rx="7" ry="5" fill="currentColor" />
              </svg>
            </button>
            <button
              type="button"
              data-tool="fill"
              title="Fill"
              aria-label="Fill"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M7 4l6 6-6 6-3-3 6-6-3-3zM16 18h4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          <div class="tool-row">
            <button
              id="zoomOut"
              type="button"
              title="Zoom out (-)"
              aria-label="Zoom out"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M5 12h14"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                />
              </svg>
            </button>
            <button
              id="zoomIn"
              type="button"
              title="Zoom in (+)"
              aria-label="Zoom in"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M12 5v14M5 12h14"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                />
              </svg>
            </button>
            <button
              id="zoomFit"
              type="button"
              title="Zoom to fit (0)"
              aria-label="Zoom to fit"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M4 9V4h5M20 9V4h-5M4 15v5h5M20 15v5h-5"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
          </div>
          <div class="tool-row view-row">
            <label for="viewToolSelect">View</label>
            <select id="viewToolSelect" name="view">
              <option value="color">Color</option>
              <option value="mono">Mono</option>
              <option value="green">Green</option>
              <option value="amber">Amber</option>
            </select>
          </div>
          <div class="tool-row color-preview">
            <div class="swatch-button fg" id="fgPreview">
              <span class="label">FG</span>
            </div>
            <button
              id="swapColors"
              type="button"
              title="Swap colors (S)"
              aria-label="Swap colors"
            >
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path
                  d="M7 7h10l-3-3m3 3-3 3M17 17H7l3 3m-3-3 3-3"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </button>
            <div class="swatch-button bg" id="bgPreview">
              <span class="label">BG</span>
            </div>
          </div>
        </section>

        <section class="panel drawing-area" aria-label="Drawing area">
          <div class="canvas-wrapper" id="canvasWrapper">
            <canvas id="drawingCanvas" width="560" height="192"></canvas>
          </div>
        </section>

        <section class="panel palette" aria-label="Color palette">
          <div class="swatch-grid" id="paletteGrid"></div>
        </section>
      </main>

      <footer class="app-footer">
        <div class="status">
          <span id="modeInfo">—</span>
          <span id="zoomInfo">—</span>
          <span id="paletteMeta">—</span>
          <span id="cursorPos">(0, 0)</span>
        </div>
      </footer>
    </div>

    <dialog id="newDialog">
      <form method="dialog" id="newForm" class="dialog-form">
        <header>
          <h3>New image</h3>
        </header>
        <label>
          Mode
          <select id="modeSelect" name="mode">
            <option value="gr">GR (Lo-Res)</option>
            <option value="dgr">DGR (Double Lo-Res)</option>
            <option value="hgr">HGR (Hi-Res)</option>
            <option value="dhgr">DHGR (Double Hi-Res)</option>
            <option value="pixmap">
              Pixmap (custom size, 256 colors, .PIXMAP)
            </option>
            <option value="bitmap">
              Bitmap (custom size, 2 colors, .BITMAP)
            </option>
          </select>
        </label>
        <div class="dimensions">
          <label>
            Width
            <input
              id="widthInput"
              name="width"
              type="number"
              min="1"
              value="40"
            />
          </label>
          <label>
            Height
            <input
              id="heightInput"
              name="height"
              type="number"
              min="1"
              value="48"
            />
          </label>
        </div>
        <menu class="dialog-actions">
          <button value="cancel" type="reset">Cancel</button>
          <button value="ok" type="submit">Create</button>
        </menu>
      </form>
    </dialog>

    <dialog id="settingsDialog">
      <form method="dialog" id="settingsForm" class="dialog-form">
        <header>
          <h3>Settings</h3>
        </header>
        <label class="inline">
          <input type="checkbox" id="prefGrid" checked />
          Show grid when zoom ≥ 4
        </label>
        <label>
          Default zoom
          <input type="number" id="prefZoom" min="1" max="24" value="8" />
        </label>
        <menu class="dialog-actions">
          <button value="cancel" type="reset">Cancel</button>
          <button value="ok" type="submit">Save</button>
        </menu>
      </form>
    </dialog>

    <dialog id="aboutDialog">
      <form method="dialog" class="dialog-form">
        <header>
          <h3>About</h3>
        </header>
        <p>Simple image editor for Apple II Grachis modes.</p>
        <p>
          GR (Lo-Res), DGR (Double Lo-Res), HGR (Hi-Res), and DHGR (Double
          Hi-Res) graphics.
        </p>
        <p>No server. No transpiler. Just HTML, CSS, and JavaScript.</p>
        <nav class="dialog-links">
          <a href="https://iolo.kr" target="_blank" rel="noreferrer noopener"
            >Home</a
          >
          <a
            href="https://github.com/iolo/apple2-image-editor"
            target="_blank"
            rel="noreferrer noopener"
            >GitHub</a
          >
        </nav>
        <menu class="dialog-actions">
          <button value="ok" type="submit">Close</button>
        </menu>
      </form>
    </dialog>

    <dialog id="dimensionDialog">
      <form method="dialog" id="dimensionForm" class="dialog-form">
        <header>
          <h3>Image size</h3>
        </header>
        <p class="muted">Enter width and height for this file.</p>
        <div class="dimensions">
          <label>
            Width
            <input
              id="dimWidth"
              name="width"
              type="number"
              min="1"
              value="64"
              required
            />
          </label>
          <label>
            Height
            <input
              id="dimHeight"
              name="height"
              type="number"
              min="1"
              value="64"
              required
            />
          </label>
        </div>
        <menu class="dialog-actions">
          <button value="cancel" type="reset">Cancel</button>
          <button value="ok" type="submit">OK</button>
        </menu>
      </form>
    </dialog>

    <dialog id="importDialog">
      <form method="dialog" id="importForm" class="dialog-form">
        <header>
          <h3>Import image</h3>
        </header>
        <p class="muted" id="importInfo">Source image size.</p>
        <label>
          Mode
          <select id="importModeSelect" name="mode">
            <option value="gr">GR (Lo-Res)</option>
            <option value="dgr">DGR (Double Lo-Res)</option>
            <option value="hgr">HGR (Hi-Res)</option>
            <option value="dhgr">DHGR (Double Hi-Res)</option>
            <option value="pixmap">
              Pixmap (custom size, 256 colors, .PIXMAP)
            </option>
            <option value="bitmap">
              Bitmap (custom size, 2 colors, .BITMAP)
            </option>
          </select>
        </label>
        <div class="dimensions">
          <label>
            Width
            <input
              id="importWidth"
              name="width"
              type="number"
              min="1"
              value="40"
            />
          </label>
          <label>
            Height
            <input
              id="importHeight"
              name="height"
              type="number"
              min="1"
              value="48"
            />
          </label>
        </div>
        <label>
          Dithering
          <select id="importDitherSelect" name="dither">
            <option value="none">Nearest (no dithering)</option>
            <option value="floyd">Floyd-Steinberg</option>
          </select>
        </label>
        <p class="muted">Image will be scaled to the target size.</p>
        <menu class="dialog-actions">
          <button value="cancel" type="reset">Cancel</button>
          <button value="ok" type="submit">Import</button>
        </menu>
      </form>
    </dialog>

    <script type="module" src="app.mjs" defer></script>
  </body>
</html>
